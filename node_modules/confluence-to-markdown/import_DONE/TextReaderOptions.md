# TextReaderOptions

TextReaderOptions is a configuration XML that is consumed by [FileService](/t/FileService) and [ExcelService](/t/ExcelService) adapters.

It allows you to specify the detailed parameters for the adapters on how the files should be imported, e.g. date formats, leading and trailing records, etc.

# Example

This is an example TextReaderOptions configuration:

``` xml
<TextReaderOptions
    IgnoreFirst="0"
    >
    <FieldOptions>
        <Option
            Name="IssueDate"
            Format="d .M .yyyy"
            >
            <AlternativeFormats>
                <Format>d.M.yyyy</Format>
                <Format>d .M .yyyy</Format>
                <Format>d.M .yyyy</Format>
                <Format>d.MM.yyyy</Format>
                <Format>dd.M .yyyy</Format>
                <Format>dd.MM.yyyy</Format>
            </AlternativeFormats>
        </Option>
    </FieldOptions>
</TextReaderOptions>
```

# XML Structure

This part describes the elements that TextReaderOptions can contain.

TextReaderOptions Element (root)

<table class="confluenceTable">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<th class="confluenceTh">IgnoreFirst</th>
<td class="confluenceTd">Number of lines to ignore from the beginning of the file. E.g. <code>"1"</code> for a header line.</td>
</tr>
<tr class="even">
<th class="confluenceTh">IgnoreLast</th>
<td class="confluenceTd">Number of lines to ignore at the end of the file. E.g. <code>"1"</code> for a footer line.</td>
</tr>
<tr class="odd">
<th class="confluenceTh">Separator</th>
<td class="confluenceTd">Column delimiter (in case of flat files). E.g. <code>","</code> for comma or <code>"    "</code> for tab.</td>
</tr>
<tr class="even">
<th class="confluenceTh">FieldOptions</th>
<td class="confluenceTd"><p>List of options for each data field.</p>
<p><strong>ExcelService -</strong> You need to define only the date fields if they are stored as strings (even in multiple formats) in Excel. All other fields can be skipped since they will get parsed by the target entity's structure.</p>
<p><strong>FileService -</strong> You need to describe all the fields available in the delimited file. These settings will define how each field will be parsed.</p></td>
</tr>
</tbody>
</table>

FieldOptions Element

|        |                           |
|--------|---------------------------|
| Option | Options for a data field. |

Option Element

<table class="confluenceTable">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<th class="confluenceTh">Name</th>
<td class="confluenceTd">Name of the entity field.</td>
</tr>
<tr class="even">
<th class="confluenceTh">Culture</th>
<td class="confluenceTd">A culture code (e.g. en-US) by which the data are formatted (e.g. decimal separator or a date format).</td>
</tr>
<tr class="odd">
<th class="confluenceTh">Format</th>
<td class="confluenceTd"><p>A format in which data are expected. See below for</p>
<ul>
<li><a href="http://msdn.microsoft.com/en-us/library/8kb3ddd4(v=vs.110).aspx">Custom date and time format strings</a></li>
<li><a href="http://msdn.microsoft.com/en-us/library/0c899ak8(v=vs.110).aspx">Custom numeric format strings</a></li>
</ul>
<p>If the input text is not in the specified format an error is thrown.</p>
<div>
<div>
<p>Use <strong>AlternativeFormats</strong> if there are multiple way how the input text can be formatted.</p>
</div>
</div></td>
</tr>
<tr class="even">
<th class="confluenceTh">IsQuoted</th>
<td class="confluenceTd">Denotes if the data in the field are enclosed in quotes.</td>
</tr>
<tr class="odd">
<th class="confluenceTh">QuoteChar</th>
<td class="confluenceTd">Specifies a quote character (e.g. <code>"&amp;quot;"</code>). If you need to escape the character, it has to be doubled. E.g. <code>"There is a "" here"</code>.</td>
</tr>
<tr class="even">
<th class="confluenceTh">IsOptional</th>
<td class="confluenceTd">If set to <strong>true</strong> this field may not be present in the source file.</td>
</tr>
<tr class="odd">
<th class="confluenceTh">DecimalSeparator</th>
<td class="confluenceTd">Decimal separator in case the field is numeric.</td>
</tr>
<tr class="even">
<th class="confluenceTh">Length</th>
<td class="confluenceTd">Length of the field in case of fixed-width files.</td>
</tr>
<tr class="odd">
<th class="confluenceTh">NullValue</th>
<td class="confluenceTd">Use to change any empty (null) values to something else. E.g. NullValue = "Origam" will change any null values to Origam</td>
</tr>
<tr class="even">
<th class="confluenceTh">IsIgnored</th>
<td class="confluenceTd">If set to <strong>true</strong> this field will be ignored.</td>
</tr>
<tr class="odd">
<th class="confluenceTh">AlternativeFormats</th>
<td class="confluenceTd">A list of alternative formats if the field can be formatted in multiple formats. This can be a case when e.g. the input file is hand-written and dates can be in various formats.</td>
</tr>
</tbody>
</table>

AlternativeFormats Element

<table class="confluenceTable">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<th class="confluenceTh">Format</th>
<td class="confluenceTd"><p>A format in which data are expected. See below for</p>
<ul>
<li><a href="http://msdn.microsoft.com/en-us/library/8kb3ddd4(v=vs.110).aspx">Custom date and time format strings</a></li>
<li><a href="http://msdn.microsoft.com/en-us/library/0c899ak8(v=vs.110).aspx">Custom numeric format strings</a></li>
</ul></td>
</tr>
</tbody>
</table>
