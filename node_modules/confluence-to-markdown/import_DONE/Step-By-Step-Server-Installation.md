# Step By Step Server Installation

The following article describes the steps needed to install the application server using the Setup (MSI) application and describes all the prerequisites needed.

**Table of Contents**

-   [1. Prerequisites](#StepByStepServerInstallation-1.Prerequisites)
    -   [.NET Framework 4.6](#StepByStepServerInstallation-.NETFramework4.6)
    -   [IIS](#StepByStepServerInstallation-IIS)
    -   [SQL Server](#StepByStepServerInstallation-SQLServer)
-   [2. Installation](#StepByStepServerInstallation-2.Installation)
    -   [Welcome Screen](#StepByStepServerInstallation-WelcomeScreen)
    -   [Prerequisites](#StepByStepServerInstallation-Prerequisites)
    -   [License Agreement](#StepByStepServerInstallation-LicenseAgreement)
    -   [Installation Progress](#StepByStepServerInstallation-InstallationProgress)
    -   [Finish](#StepByStepServerInstallation-Finish)
-   [3. Troubleshooting](#StepByStepServerInstallation-3.Troubleshooting)
    -   [SQL Server connection](#StepByStepServerInstallation-SQLServerconnection)
    -   [HTTP 500.21 INTERNAL SERVER ERROR](#StepByStepServerInstallation-HTTP500.21INTERNALSERVERERROR)
-   [4. Check the Results](#StepByStepServerInstallation-4.ChecktheResults)

# 1. Prerequisites

These are the prerequisites you will need:

-   .NET Framework 4.6
-   IIS 7 and higher
    -   Windows Authentication IIS Module
    -   ASP.NET 4.5 IIS Module
-   SQL Server 2008 and higher

## .NET Framework 4.6

On Windows 8 and Windows Server 2012 the framework is preinstalled.

On earlier versions you need to download it and install separately.

For more information about installing .NET Framework 4.6 see this [MSDN article](http://msdn.microsoft.com/en-us/library/5a4x27ek(v=vs.110).aspx).

## IIS

You need to install IIS with the following IIS features:

-   .NET Extensibility 4.5
-   ASP.NET 4.5
-   ISAPI Extensions
-   ISAPI Filters
-   Request Filtering
-   Windows Authentication
-   Static Content
-   Default Document
-   Directory Browsing
-   HTTP Errors
-   HTTP Logging
-   Request Monitoring
-   Static Content Compression
-   IIS Management Console

For instructions about how to install different versions of IIS on different operating systems see <http://www.iis.net/learn/install>.

This command line command should be enough to install everything for you (you need to run it with Administrator privileges):

**IIS Installation Command Line**

``` powershell
C:\Windows\system32>Start /w pkgmgr /iu:IIS-WebServerRole;IIS-WebServer;IIS-CommonHttpFeatures;IIS-StaticContent;IIS-DefaultDocument;IIS-DirectoryBrowsing;IIS-HttpErrors;IIS-ApplicationDevelopment;IIS-ASPNET45;IIS-NetFxExtensibility45;IIS-ISAPIExtensions;IIS-ISAPIFilter;IIS-HealthAndDiagnostics;IIS-HttpLogging;IIS-LoggingLibraries;IIS-RequestMonitor;IIS-Security;IIS-RequestFiltering;IIS-HttpCompressionStatic;IIS-WebServerManagementTools;IIS-ManagementConsole;NetFx4Extended-ASPNET45;IIS-WindowsAuthentication
```

## SQL Server

You need at least SQL Server Express Edition version 2008 and higher. The latest SQL Server 2014 is fully supported.

The setup presumes (but you can change it) that you install the SQL Server on the same machine as installing the server and the SQL Server instance is named ORIGAM (so the full server name would be .\ORIGAM).

# 2. Installation

The setup wizard goes through the following steps.

## Welcome Screen

Nothing to do here, just press Continue.

![11730970_496x386](upload://av5Sxzje4ocJmaki4H2kmXcTCMT.png)

## Prerequisites

Here the setup checks for prerequisites. If all items are checked click on Continue. Otherwise check the previous parts of this guide to set up all the prerequisites.

![11730969_499x387](upload://6lVRkOles7l0JRDbqOEZ7rOv6pY.png)

## License Agreement

You need to check "I accept..." in order to continue. After that, click on Continue.

![11730968_496x386](upload://bl6dxLkr99ggoOoExznTcdW5bzR.png)

## Installation Progress

By clicking Continue on the previous page you started the installation. You will see a green moving bar and you need to wait. In this step you can see different errors that would tell you if something went wrong.

## Finish

If everything went correctly you will see the following screen.

![11730967_495x386](upload://oR6t3nvOs3IMCFsnySRigFBFVBj.png)

# 3. Troubleshooting

These are the things that can go wrong.

## SQL Server connection

In case of this error the problem is that you specified an invalid connection to the SQL Server. Either the Server Name is wrong or your credentials (Windows account or user name/password combination is not correct).

![7929877_690x272](upload://bh8AucoE8IcjGY2V1uuPtERCX2Y.png)

In case you cannot easily find out what the problem was you can try to turn on verbose logging of the MS Installer by using the command line:

``` powershell
msiexec /i ServerSetup.msi /L*v installation_log.txt
```

## HTTP 500.21 INTERNAL SERVER ERROR

You probably had .NET Framework 4/4.5 installed **before** IIS. When installing IIS after .NET Framework you need to manually register ASP.NET by running the following statement in the command line. For more information see <http://msdn.microsoft.com/en-us/library/k6h9cz8h(v=vs.100).aspx#findingthecorrectversion>.

``` powershell
aspnet_regiis.exe -i
```

# 4. Check the Results

After finishing the installation you should be able to access your website by clicking on a Programs menu shortcut **Origam Architect** under **ORIGAM** folder.

![11730974_224x83](upload://wz5TLbk13G2SSu02DBGyHXh5oVH.png)

Since by default the website is configured for Windows Authentication you should be able to enter the website with single-sign-on (without needing to login). If the browser requires you to login add "localhost" (or the external IP on which you access the site) to the **Trusted Sites**.

This is the result you should see if you go to the website via a browser:

![7929873_690x495](upload://nA2Py1Rq7Tqzym1O2r4T4DzdOVG.png)

This is the result you will see in your file system. Everything is being installed into your Program Files\ORIGAM folder.

![11730971_690x430](upload://86z9o7NX1zsIxzeOIJXsj7wYULa.png)

This is the result you should see in the Internet Information Servcies (IIS) Manager (in this case "origam" virtual directory under the Default Web Site and the "origam" application pool):

![7929874_690x341](upload://yCNtUTxsGSVSfEEOYQBv7El9fl7.png)

This is the result you should see in the SQL Server Management Console:

-   origam_Data - database that contains application data
-   origam_Model - database that contains the application model
-   IIS APPPOOL\ORIGAM user - an IIS application user under which IIS will connect to the database (in case Windows Authentication was selected for the database access).

![7929875_378x500](upload://9eX34o04oMHlYw15wuL0cqCjxtb.png)
