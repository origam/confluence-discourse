<!DOCTYPE html>
<html>
    <head>
        <title>ORIGAM Documentation : LookupOrCreate</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">ORIGAM Documentation</a></span>
                            </li>
                                                    <li>
                                <span><a href="ORIGAM-Enterprise-Home_589829.html">ORIGAM Enterprise Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="ORIGAM-Architect_8716616.html">ORIGAM Architect</a></span>
                            </li>
                                                    <li>
                                <span><a href="XSLT-Reference_589831.html">XSLT Reference</a></span>
                            </li>
                                                    <li>
                                <span><a href="AS-Other-Functions_589904.html">AS Other Functions</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            ORIGAM Documentation : LookupOrCreate
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
    
        
    
        
        
            Created by <span class='author'> Tomáš Vavrda</span>, last modified on Feb 22, 2017
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p>This function works the same way as LookupValue but in case nothing is found it will create the missing record. This is useful for integration and ETL projects where you can simplify the data import scripts. </p><h3 id="LookupOrCreate-Namespace">Namespace</h3><p><code>xmlns:AS=&quot;http://schema.advantages.cz/AsapFunctions&quot;</code></p><h3 id="LookupOrCreate-Syntax">Syntax</h3><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: csharp; gutter: false; theme: Confluence" data-theme="Confluence">string LookupOrCreate(string lookupElementId, string parameterValue, NodeSet createParameters)</pre>
</div></div><h3 id="LookupOrCreate-Parameters">Parameters</h3><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"><p>lookupId</p></th><td class="confluenceTd"><p>Unique identifier (Guid) of lookup model element</p></td></tr><tr><th colspan="1" class="confluenceTh">parameterValue</th><td colspan="1" class="confluenceTd">Value to lookup by (that the lookup's data structure will use as a filter parameter).</td></tr><tr><th colspan="1" class="confluenceTh">createParameters</th><td colspan="1" class="confluenceTd">Key-value pairs providing data for a new record (in case it does not exist).</td></tr></tbody></table></div><h3 id="LookupOrCreate-Remarks">Remarks</h3><p>This function uses the <strong>ListDataStructure</strong> entity of the lookup for creating the record. For this you will need to set <strong>AllFields</strong> to <code>True</code> so the data will be safely inserted to the database. This is mandatory. Primary key and other system fields (creation time and user) will be filled in automatically.</p><p> </p><div class="confluence-information-macro confluence-information-macro-information"><p class="title">Warning</p><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>You should use this function carefully as it writes data during transformations. Especially be careful when state-machines exist on the entity being written to. For a sake of simplicity you should mainly use this function for inserting missing records into simple lists e.g. while importing data from external data sources.</p></div></div><h3 id="LookupOrCreate-Example">Example</h3><div class="code panel pdl" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>Stylesheet</b></div><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: html/xml; gutter: true; theme: Confluence" data-theme="Confluence">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;xsl:stylesheet xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;1.0&quot;
    xmlns:AS=&quot;http://schema.advantages.cz/AsapFunctions&quot;
    xmlns:date=&quot;http://exslt.org/dates-and-times&quot; exclude-result-prefixes=&quot;AS date&quot;&gt;
    &lt;xsl:template match=&quot;ROOT&quot;&gt;
        &lt;!-- we are trying to get an airline id by its code --&gt;
        &lt;xsl:variable name=&quot;code&quot; select=&quot;&#39;OA&#39;&quot;/&gt;
        &lt;ROOT&gt;
	        &lt;!-- if not found we let it to be created --&gt;
            &lt;xsl:variable name=&quot;valueParams&quot;&gt;
                &lt;parameter key=&quot;Name&quot; value=&quot;Origam Air&quot;/&gt;
                &lt;parameter key=&quot;IataCode&quot; value=&quot;{$code}&quot;/&gt;
            &lt;/xsl:variable&gt;
            &lt;airlineId&gt;
		        &lt;!-- this single function will then always return a value --&gt;
                &lt;xsl:value-of select=&quot;AS:LookupOrCreate(&#39;3abe98c3-e3b1-4960-b426-1f69532f8cd0&#39;, $code, $valueParams)&quot;/&gt;
            &lt;/airlineId&gt;
        &lt;/ROOT&gt;
    &lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;</pre>
</div></div>
                    </div>

                                        
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Jun 29, 2022 20:33</p>
                    <div id="footer-logo"><a href="https://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
