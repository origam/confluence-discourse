<!DOCTYPE html>
<html>
    <head>
        <title>ORIGAM Documentation : HttpRequest</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">ORIGAM Documentation</a></span>
                            </li>
                                                    <li>
                                <span><a href="ORIGAM-Enterprise-Home_589829.html">ORIGAM Enterprise Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="ORIGAM-Architect_8716616.html">ORIGAM Architect</a></span>
                            </li>
                                                    <li>
                                <span><a href="XSLT-Reference_589831.html">XSLT Reference</a></span>
                            </li>
                                                    <li>
                                <span><a href="AS-Other-Functions_589904.html">AS Other Functions</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            ORIGAM Documentation : HttpRequest
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
    
        
    
        
        
            Created by <span class='author'> Tomáš Vavrda</span>, last modified by <span class='editor'> Filip Tvrdoň</span> on Nov 30, 2016
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p>Sends a GET HTTP request and returns its data back.</p><h3 id="HttpRequest-Namespace">Namespace</h3><p><code>xmlns:AS=&quot;http://schema.advantages.cz/AsapFunctions&quot;</code></p><h3 id="HttpRequest-Syntax">Syntax</h3><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: csharp; gutter: false; theme: Confluence" data-theme="Confluence">string HttpRequest(string url)</pre>
</div></div><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: c#; gutter: false; theme: Confluence" data-theme="Confluence">string HttpRequest(string url, string authenticationType, string username, string password)</pre>
</div></div><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: c#; gutter: false; theme: Confluence" data-theme="Confluence">string HttpRequest(string url, string method, string content, string contentType, XPathNavigator headers)</pre>
</div></div><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: c#; gutter: false; theme: Confluence" data-theme="Confluence">string HttpRequest(string url, string method, string content, XPathNavigator headers, string authenticationType, string username, string password)</pre>
</div></div><p> </p><h3 id="HttpRequest-Parameters">Parameters</h3><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Description</p></th></tr><tr><td class="confluenceTd"><p>url</p></td><td class="confluenceTd"><p>Url requested.</p></td></tr><tr><td colspan="1" class="confluenceTd">authenticationType</td><td colspan="1" class="confluenceTd">Type of authentication. Example 'Basic'</td></tr><tr><td colspan="1" class="confluenceTd">username</td><td colspan="1" class="confluenceTd">Login username</td></tr><tr><td colspan="1" class="confluenceTd">password</td><td colspan="1" class="confluenceTd">Login password</td></tr><tr><td colspan="1" class="confluenceTd">method</td><td colspan="1" class="confluenceTd">Send method, e.g. GET or POST</td></tr><tr><td colspan="1" class="confluenceTd">content</td><td colspan="1" class="confluenceTd">Content to send</td></tr><tr><td colspan="1" class="confluenceTd">headers</td><td colspan="1" class="confluenceTd">Array of header parameters</td></tr></tbody></table></div><h3 id="HttpRequest-Remarks">Remarks</h3><p>If a file is returned as a result of the request, it is encoded as Base64 string.</p><p>In order to parse the XML using XPath, the resulting string has to be converted using <a class="createlink" href="/pages/createpage.action?spaceKey=architect&amp;title=ToXml&amp;linkCreation=true&amp;fromPageId=1277987">ToXml()</a> function.</p><h3 id="HttpRequest-Headers">Headers</h3><p>Array of header parameters for request.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: xml; gutter: false; theme: Confluence" data-theme="Confluence">&lt;xsl:variable name=&quot;headerRequest&quot;&gt;
	&lt;header name=&quot;Content-Encoding&quot; value=&quot;gzip&quot; /&gt;
	&lt;header name=&quot;Option&quot; value=&quot;value&quot; /&gt;
&lt;/xsl:variable&gt;</pre>
</div></div><p> </p><h3 id="HttpRequest-Example">Example</h3><p>This example loads data from an official company registry web service, extracts data and saves them to the address book.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>Source XML</b></div><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: html/xml; gutter: true; theme: Confluence" data-theme="Confluence">&lt;ROOT&gt;
	&lt;BusinessPartner LegalRegistrationCode=&quot;123456789&quot;/&gt;
&lt;/ROOT&gt;</pre>
</div></div><div class="code panel pdl" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>Stylesheet</b></div><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: html/xml; gutter: true; theme: Confluence" data-theme="Confluence">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;xsl:stylesheet xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;1.0&quot;
	xmlns:AS=&quot;http://schema.advantages.cz/AsapFunctions&quot;
	xmlns:are=&quot;http://wwwinfo.mfcr.cz/ares/xml_doc/schemas/ares/ares_answer_basic/v_1.0.3&quot;
	xmlns:D=&quot;http://wwwinfo.mfcr.cz/ares/xml_doc/schemas/ares/ares_datatypes/v_1.0.3&quot;
	xmlns:date=&quot;http://exslt.org/dates-and-times&quot; 
	exclude-result-prefixes=&quot;AS date are D&quot;&gt;
	&lt;xsl:template match=&quot;ROOT&quot;&gt;
		&lt;ROOT&gt;
			&lt;xsl:apply-templates select=&quot;BusinessPartner&quot;/&gt;
		&lt;/ROOT&gt;
	&lt;/xsl:template&gt;
	&lt;xsl:template match=&quot;BusinessPartner&quot;&gt;
		&lt;xsl:if test=&quot;string(@LegalRegistrationCode)&quot;&gt;
			&lt;!-- get data from a web service --&gt;
			&lt;xsl:variable name=&quot;aresResult&quot; select=&quot;AS:HttpRequest(concat(&#39;http://wwwinfo.mfcr.cz/cgi-bin/ares/darv_bas.cgi?ico=&#39;, @LegalRegistrationCode))&quot;/&gt;
			&lt;!-- convert data to XML node so it can be accessed using XPath query --&gt;
			&lt;xsl:variable name=&quot;aresResultXml&quot; select=&quot;AS:ToXml($aresResult)&quot;/&gt;
			&lt;xsl:variable name=&quot;error&quot; select=&quot;$aresResultXml/are:Ares_odpovedi/are:Odpoved/D:E/D:ET&quot;/&gt;
			&lt;xsl:variable name=&quot;zaklad&quot; select=&quot;$aresResultXml/are:Ares_odpovedi/are:Odpoved/D:VBAS&quot;/&gt;
			&lt;xsl:variable name=&quot;address&quot; select=&quot;$zaklad/D:AA&quot;/&gt;
			
			&lt;!-- terminate transformation on error --&gt;
			&lt;xsl:if test=&quot;string($error)&quot;&gt;
				&lt;xsl:message terminate=&quot;yes&quot;&gt;&lt;xsl:value-of select=&quot;$error&quot;/&gt;&lt;/xsl:message&gt;
			&lt;/xsl:if&gt;
			
			&lt;xsl:copy&gt;
				&lt;!-- copy all attributes --&gt;
				&lt;xsl:copy-of select=&quot;@*&quot;/&gt;
				&lt;!-- replace Tax ID attribute with the value from the web service --&gt;
				&lt;xsl:attribute name=&quot;TaxIdentificationCode&quot;&gt;&lt;xsl:value-of select=&quot;$zaklad/D:DIC&quot;/&gt;&lt;/xsl:attribute&gt;
				&lt;!-- copy all nodes --&gt;
				&lt;xsl:copy-of select=&quot;*[name() != &#39;Name&#39; and name() != &#39;BusinessPartnerCommunicationChannel&#39;]&quot;/&gt;
				&lt;!-- replace the name of the company with the value from the web service --&gt;
				&lt;Name&gt;&lt;xsl:value-of select=&quot;$zaklad/D:OF&quot;/&gt;&lt;/Name&gt;
				
				&lt;xsl:choose&gt;
					&lt;!-- if there is no legal address, create it --&gt;
					&lt;xsl:when test=&quot;count(BusinessPartnerCommunicationChannel[
						@refBusinessPartnerCommunicationChannelTypeId = 
						AS:GetConstant(&#39;BusinessPartnerCommunicationChannelType_AddressLegal&#39;)
						]) = 0&quot;&gt;
						&lt;BusinessPartnerCommunicationChannel
							Id=&quot;{AS:GenerateId()}&quot;
							refBusinessPartnerCommunicationChannelTypeId=&quot;{
								AS:GetConstant(&#39;BusinessPartnerCommunicationChannelType_AddressLegal&#39;)}&quot;
							&gt;
								&lt;xsl:call-template name=&quot;SetAddress&quot;&gt;
									&lt;xsl:with-param name=&quot;address&quot; select=&quot;$address&quot;/&gt;
								&lt;/xsl:call-template&gt;
						&lt;/BusinessPartnerCommunicationChannel&gt;
					&lt;/xsl:when&gt;
					&lt;!-- otherwise replace the current address with the one returned by the web service --&gt;
					&lt;xsl:otherwise&gt;
						&lt;xsl:apply-templates select=&quot;BusinessPartnerCommunicationChannel[
						@refBusinessPartnerCommunicationChannelTypeId = 
						AS:GetConstant(&#39;BusinessPartnerCommunicationChannelType_AddressLegal&#39;)
						]&quot;&gt;
							&lt;xsl:with-param name=&quot;address&quot; select=&quot;$address&quot;/&gt;
						&lt;/xsl:apply-templates&gt;
					&lt;/xsl:otherwise&gt;
				&lt;/xsl:choose&gt;
			&lt;/xsl:copy&gt;
		&lt;/xsl:if&gt;
	&lt;/xsl:template&gt;
	
	&lt;xsl:template match=&quot;BusinessPartnerCommunicationChannel&quot;&gt;
		&lt;xsl:param name=&quot;address&quot;/&gt;
		
		&lt;xsl:copy&gt;
			&lt;xsl:copy-of select=&quot;@*&quot;/&gt;
			&lt;xsl:call-template name=&quot;SetAddress&quot;&gt;
				&lt;xsl:with-param name=&quot;address&quot; select=&quot;$address&quot;/&gt;
			&lt;/xsl:call-template&gt;
			&lt;xsl:copy-of select=&quot;*&quot;/&gt;
		&lt;/xsl:copy&gt;
	&lt;/xsl:template&gt;
	
	&lt;xsl:template name=&quot;SetAddress&quot;&gt;
		&lt;xsl:param name=&quot;address&quot;/&gt;
		&lt;xsl:attribute name=&quot;Street1&quot;&gt;&lt;xsl:value-of select=&quot;$address/D:NU&quot;/&gt;&lt;/xsl:attribute&gt;
		&lt;xsl:attribute name=&quot;HouseNumber&quot;&gt;&lt;xsl:value-of select=&quot;$address/D:CD&quot;/&gt;&lt;/xsl:attribute&gt;
		&lt;xsl:attribute name=&quot;PostalCode&quot;&gt;&lt;xsl:value-of select=&quot;$address/D:PSC&quot;/&gt;&lt;/xsl:attribute&gt;
		&lt;xsl:attribute name=&quot;City&quot;&gt;&lt;xsl:value-of select=&quot;$address/D:N&quot;/&gt;&lt;/xsl:attribute&gt;
	&lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;</pre>
</div></div><p><span style="color: rgb(241,101,80);"><br/></span></p><p><strong><span style="color: rgb(241,101,80);">EXAMPLE 2</span></strong></p><p>Using httpRequest with authentication.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: xml; gutter: false; theme: Confluence" data-theme="Confluence">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;xsl:stylesheet xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;1.0&quot;
	xmlns:AS=&quot;http://schema.advantages.cz/AsapFunctions&quot;
	xmlns:date=&quot;http://exslt.org/dates-and-times&quot; 
	xmlns:str=&quot;http://exslt.org/strings&quot;
    exclude-result-prefixes=&quot;AS date str&quot;&gt;
	&lt;xsl:param name=&quot;text&quot;/&gt;
	&lt;xsl:param name=&quot;phoneNumber&quot;/&gt;
	
	&lt;xsl:template match=&quot;/&quot;&gt;
		
		&lt;xsl:variable name=&quot;rawGateway&quot; select=&quot;AS:GetConstant(&#39;GTS_GatewayURL&#39;)&quot;/&gt;
		&lt;xsl:variable name=&quot;username&quot; select=&quot;AS:GetConstant(&#39;GTS_Username&#39;)&quot; /&gt;
		&lt;xsl:variable name=&quot;password&quot; select=&quot;AS:GetConstant(&#39;GTS_Password&#39;)&quot; /&gt;
		&lt;xsl:variable name=&quot;authType&quot; select=&quot;&#39;Basic&#39;&quot; /&gt;
				
		&lt;xsl:variable name=&quot;sms&quot; select=&quot;AS:HttpRequest(concat(
			$rawGateway,
			&#39;?MT_Destination=&#39;,	translate($phoneNumber, &#39; &#39;, &#39;&#39;),
			&#39;&amp;amp;MT_Type=SMS&#39;, &#39;&amp;amp;MT_SubType=Text&#39;,
			&#39;&amp;amp;MT_Data=&#39;,$text), $authType, $username, $password )&quot;/&gt;
		
		&lt;!-- split return code by ;--&gt;
		&lt;xsl:variable name=&quot;result&quot; select=&quot;str:split($sms, &#39;;&#39;)&quot;/&gt;
		
		&lt;ROOT&gt;
		&lt;xsl:choose&gt;
			&lt;xsl:when test=&quot;$result[1]=&#39;REJECT&#39;&quot;&gt;
				&lt;xsl:message terminate=&quot;yes&quot;&gt;&lt;xsl:value-of select=&quot;concat(&#39;REJECT:Selhalo odeslání SMS na číslo &#39;, $phoneNumber, &#39;. Chyba: &#39;, $result[2])&quot;/&gt;&lt;/xsl:message&gt;
			&lt;/xsl:when&gt;
			&lt;xsl:when test=&quot;$result[1]=&#39;ERROR&#39;&quot;&gt;
				&lt;xsl:message terminate=&quot;yes&quot;&gt;&lt;xsl:value-of select=&quot;concat(&#39;ERROR:Selhalo odeslání SMS na číslo &#39;, $phoneNumber, &#39;. Chyba: &#39;, $result[2])&quot;/&gt;&lt;/xsl:message&gt;
			&lt;/xsl:when&gt;
			&lt;xsl:when test=&quot;$result[1]=&#39;THROTTLING-ACTIVE&#39;&quot;&gt;
				&lt;xsl:message terminate=&quot;yes&quot;&gt;&lt;xsl:value-of select=&quot;concat(&#39;Dosažen maximální počet odeslání sms, vyčkejte &#39;, $result[2], &#39; s.&#39;)&quot;/&gt;&lt;/xsl:message&gt;
			&lt;/xsl:when&gt;
		&lt;/xsl:choose&gt;
		&lt;/ROOT&gt;
	&lt;/xsl:template&gt;
	
&lt;/xsl:stylesheet&gt;</pre>
</div></div><p><br/><br/></p><p> </p><p> </p>
                    </div>

                                        
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Jun 29, 2022 20:33</p>
                    <div id="footer-logo"><a href="https://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
