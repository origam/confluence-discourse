<!DOCTYPE html>
<html>
    <head>
        <title>ORIGAM Documentation : How To Create a Custom Work Queue Action</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">ORIGAM Documentation</a></span>
                            </li>
                                                    <li>
                                <span><a href="ORIGAM-Enterprise-Home_589829.html">ORIGAM Enterprise Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="How-to-articles_7831641.html">How-to articles</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            ORIGAM Documentation : How To Create a Custom Work Queue Action
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
    
        
    
        
        
            Created by <span class='author'> Tomáš Vavrda</span>, last modified on Sep 05, 2014
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p>When changing a record's state or value is not enough for the work queue command, you need to create a custom action.</p><p>Custom action is essentially a <a href="Sequential-Workflows_4620321.html">sequential workflow</a> assigned to the work queue.</p><p>In this example we will create a sequential workflow, that will close a Sales Order. While closing the sales order it will have to update multiple data at once, so we could not use a simple state change work queue action.</p><h1 id="HowToCreateaCustomWorkQueueAction-1.CreateaSequentialWorkflow">1. Create a Sequential Workflow</h1><p>The sequential workflow will consist of:</p><ul><li>Input Work Queue Context</li><li>SalesOrder context</li><li>Steps to load/transform/save the sales order</li><li>Steps to delete the item from the work queue</li></ul><h2 id="HowToCreateaCustomWorkQueueAction-Contexts">Contexts</h2><p>Create the following Contexts in the sequential workflow:</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Name</th><th class="confluenceTh">Data Type</th><th class="confluenceTh">Data Structure</th><th colspan="1" class="confluenceTh">Remarks</th></tr><tr><th class="confluenceTh">WQ_SalesOrder</th><td class="confluenceTd">Xml</td><td class="confluenceTd">WQ_SalesOrder</td><td colspan="1" class="confluenceTd">This is an input context that will contain the selected queue entry.</td></tr><tr><th colspan="1" class="confluenceTh">SalesOrder</th><td colspan="1" class="confluenceTd">Xml</td><td colspan="1" class="confluenceTd">SalesOrder</td><td colspan="1" class="confluenceTd">This is a context where we will load the sales order connected to the work queue entry, modify its values and save back to the database.</td></tr></tbody></table></div><h2 id="HowToCreateaCustomWorkQueueAction-Tasks">Tasks</h2><p>Right click on the SalesOrder context and select <strong>Actions &gt; Load/Transform/Save</strong> Tasks.</p><p>This will create 3 tasks where you will need to fill in some missing parameters.</p><ul><li>Under the step 01 open the <strong>DataStructure</strong> node and set the <strong>FilterSet</strong> property so it loads by primary key (typically named GetId). If you do not have such a Filter Set defined, you have to define it first.</li><li><p>Under the step 01 open the <strong>Parameters </strong>node<strong>, </strong>right click on it and select <strong>New &gt; Context Store Reference </strong>and fill in the following values:</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Property Name</th><th class="confluenceTh">Value</th><th colspan="1" class="confluenceTh">Remarks</th></tr><tr><th colspan="1" class="confluenceTh">Name</th><td colspan="1" class="confluenceTd">SalesOrder_parId</td><td colspan="1" class="confluenceTd">This is the parameter name that is requested by the data structure's filter set that you selected. In your case you have to update this name according to your own data structure.</td></tr><tr><th colspan="1" class="confluenceTh">ContextStore</th><td colspan="1" class="confluenceTd"><span>WQ_SalesOrder</span></td><td colspan="1" class="confluenceTd">Here select the work queue entry. There from we will get the Id of the record we need to update.</td></tr><tr><th colspan="1" class="confluenceTh">XPath</th><td colspan="1" class="confluenceTd">/ROOT/WorkQueueEntry/@refId</td><td colspan="1" class="confluenceTd">This is the XPath pointing to the Id of the sales order in the work queue entry.</td></tr></tbody></table></div></li></ul><ul><li>Now create a transformation that will actually update your data. It can look something like this:</li></ul><div class="code panel pdl" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>Transformation Example</b></div><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: html/xml; gutter: true; theme: Confluence" data-theme="Confluence">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;xsl:stylesheet xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;1.0&quot;
	xmlns:AS=&quot;http://schema.advantages.cz/AsapFunctions&quot;
	xmlns:date=&quot;http://exslt.org/dates-and-times&quot; exclude-result-prefixes=&quot;AS date&quot;&gt;
	&lt;xsl:template match=&quot;ROOT&quot;&gt;
		&lt;ROOT&gt;
			&lt;xsl:apply-templates select=&quot;SalesOrder&quot;/&gt;
		&lt;/ROOT&gt;
	&lt;/xsl:template&gt;
	&lt;xsl:template match=&quot;SalesOrder&quot;&gt;
		&lt;xsl:copy&gt;
			&lt;xsl:copy-of select=&quot;@*&quot;/&gt;
			&lt;xsl:attribute name=&quot;refSalesOrderStateId&quot;&gt;&lt;xsl:value-of select=&quot;AS:GetConstant(&#39;SalesOrder_Closed&#39;)&quot;/&gt;&lt;/xsl:attribute&gt;
			&lt;xsl:copy-of select=&quot;*[name() != &#39;SalesOrderDetail&#39;]&quot;/&gt;
			&lt;xsl:apply-templates select=&quot;SalesOrderDetail&quot;/&gt;
		&lt;/xsl:copy&gt;
	&lt;/xsl:template&gt;
	&lt;xsl:template match=&quot;SalesOrderDetail&quot;&gt;
		&lt;xsl:copy&gt;
			&lt;xsl:copy-of select=&quot;@*&quot;/&gt;
			&lt;xsl:attribute name=&quot;DateClosed&quot;&gt;&lt;xsl:value-of select=&quot;date:date-time()&quot;/&gt;&lt;/xsl:attribute&gt;
			&lt;xsl:copy-of select=&quot;*&quot;/&gt;
		&lt;/xsl:copy&gt;
	&lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;</pre>
</div></div><h1 id="HowToCreateaCustomWorkQueueAction-2.AssigntotheWorkQueueClass">2. Assign to the Work Queue Class</h1><p> </p><h1 id="HowToCreateaCustomWorkQueueAction-3.ConfiguretheWorkQueue">3. Configure the Work Queue</h1>
                    </div>

                                        
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Jun 29, 2022 20:33</p>
                    <div id="footer-logo"><a href="https://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
