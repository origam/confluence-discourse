<!DOCTYPE html>
<html>
    <head>
        <title>ORIGAM Documentation : Data Page</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">ORIGAM Documentation</a></span>
                            </li>
                                                    <li>
                                <span><a href="ORIGAM-Enterprise-Home_589829.html">ORIGAM Enterprise Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="ORIGAM-Architect_8716616.html">ORIGAM Architect</a></span>
                            </li>
                                                    <li>
                                <span><a href="Model-Reference_4620401.html">Model Reference</a></span>
                            </li>
                                                    <li>
                                <span><a href="8290890.html">Web API/Pages</a></span>
                            </li>
                                                    <li>
                                <span><a href="API-Page-Types_8716448.html">API Page Types</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            ORIGAM Documentation : Data Page
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
    
        
    
        
        
            Created by <span class='author'> Tomáš Vavrda</span>, last modified by <span class='editor'> Václav Urbánek</span> on Dec 30, 2016
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p>Data page can be used to expose <a href="http://en.wikipedia.org/wiki/Create,_read,_update_and_delete" class="external-link" rel="nofollow">CRUD</a> data operations.Using a Data Page you can</p><ul><li>Expose data in different formats (XML, JSON, HTML, CSV...) using <code>GET</code> and <code>POST</code> requests</li><li>Insert or update records using <code>PUT</code> requests</li><li>Delete records using <code>DELETE</code> requests</li></ul><h1 id="DataPage-Attributes">Attributes</h1><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh">DataStructure</th><td class="confluenceTd">Data Structure the data will be based on.</td></tr><tr><th class="confluenceTh">Method</th><td class="confluenceTd">Optional method (filter) to be used for getting the data.</td></tr><tr><th colspan="1" class="confluenceTh">SortSet</th><td colspan="1" class="confluenceTd">Optional sort set using which the data will be sorted.</td></tr><tr><th colspan="1" class="confluenceTh">Transformation</th><td colspan="1" class="confluenceTd"><p>Optional XSLT Transformation that will be used to transform the data returned by the data service using the DataStructure attribute.</p><p>If Transformation is omitted the result is the raw data as returned by the data service in a format depending on a specified MimeType:</p><ul><li><code>application/xml –</code> will produce an XML document</li><li><code>application/json –</code> will produce a JSON document</li></ul><p>If you want to provide data in another format you need to use the transformation to produce data in such a format. The above specified formats can be used without a transformation and data will be converted automatically.</p><p>When <strong>MimeType</strong> is application/json, please consider to define also <strong>TransformationOutputStructure</strong>.</p><p> </p></td></tr><tr><th colspan="1" class="confluenceTh">TransformationOutputStructure</th><td colspan="1" class="confluenceTd">A data structure where an output of the <strong>Transformation</strong> will be merged into. It's applied only when <strong>ResultXpath</strong> is not set and a <strong>MimeType</strong> field is set to application/json.If not defined, the final XML-&gt;JSON conversion after transformation works the following way: DataTypes - float, int, boolen, etc. are converted to string, attributes are prefixed with @. But if defined, conversion is DataSet-&gt;JSON conversion, which performs the standard way (as without transformation).</td></tr><tr><th colspan="1" class="confluenceTh">ResultXPath</th><td colspan="1" class="confluenceTd"><p>In case you need a single value or only a subset of the produced data you can use an XPath expression to select only the data you need to return.</p><p>A string value of the resulting Xpath navigator ia used. It's mainly used for extracting pure text out of the result xml. If it's set and application/json mime-type is set too, then resulting JSON conversion is always done as a non-typed XML-&gt;JSON conversion (regardless of how Transformation and TransformationOutputStructure are set).</p></td></tr><tr><th colspan="1" class="confluenceTh">AllowPUT</th><td colspan="1" class="confluenceTd">If set to <strong>True</strong> it will be possible to use a <code>PUT</code> HTTP request to send data back to the API to be saved to the database.</td></tr><tr><th colspan="1" class="confluenceTh">AllowDELETE</th><td colspan="1" class="confluenceTd"><span>If set to <strong>True</strong> it will be possible to use a <code>DELETE</code> HTTP request to send data back to the API to be deleted from the database.</span></td></tr><tr><th colspan="1" class="confluenceTh">SaveValidationBeforeMerge</th><td colspan="1" class="confluenceTd"><p>A validation rule that will be called on the data loaded from the database before the data from input is merged into.</p></td></tr><tr><th colspan="1" class="confluenceTh">SaveValidationAfterMerge</th><td colspan="1" class="confluenceTd"><p>A validation rule that will be called after merging the data from a database with a data from input. This can be used for validating the resulting (updated) data before saving them in a database.</p><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>You will probably have the same validation rule set up as a state event anyway so any data access is always validated but you can assign the same rule here because it is cheaper to stop the web request if it is invalid than locking data in the database and validating them later in the process.</p></div></div></td></tr><tr><th colspan="1" class="confluenceTh">LogTransformation</th><td colspan="1" class="confluenceTd">An XSLT transformation that will produce enhanced logging data. For details see <a href="How-to-set-up-an-event-logging-with-Log-Transformations_6062141.html">How to set up an event logging with Log Transformations</a>.</td></tr><tr><th colspan="1" class="confluenceTh">OmitJsonRootElement</th><td colspan="1" class="confluenceTd"><p>If set to <strong>True</strong> and the MimeType is JSON the returned JSON string will not contain the root element converted from the XML representation (e.g. &quot;ROOT&quot;).</p><p>It's applied only if a non-typed XML-&gt;JSON conversion is used (Transformation is given while TransformationOutputDatastructure is not)</p></td></tr></tbody></table></div><h1 id="DataPage-UpdatingAndInsertingData">Updating And Inserting Data</h1><p>When you want to send JSON or XML data back to the API in the HTTP request body you need to:</p><ol><li>S<span style="line-height: 1.4285715;">et </span><strong style="line-height: 1.4285715;">AllowPUT</strong><span style="line-height: 1.4285715;"> to </span><code style="line-height: 1.4285715;">True</code><span style="line-height: 1.4285715;">.</span></li><li><span style="line-height: 1.4285715;">Add a new <a href="Parameter-Mapping_8716445.html">ParameterMapping</a> under the Data Page API with any name and MappedParameter empty. This will pass the body to the API.</span></li><li><span style="line-height: 1.4285715;">Send the request under the same URL you used to load the data, e.g. <code>/api/invoice/1234</code></span></li></ol><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>It is recommended to set <strong>AllFields=True</strong> in the source data structure entities otherwise concurrency exceptions can occur.</p></div></div><p>The process then goes like this:</p><ol><li>When you send PUT request to <code>/api/invoice/1234</code> first the old invoice no. 1234 is loaded from the database</li><li>Then the data of the old invoice are updated with the data sent with the request</li><li>Then the changes are saved to the database.</li></ol><p>If you want to insert data you basically need to provide a parameter under which no invoice will be loaded, e.g.<code> /api/invoice/new</code>. The first step which loads the record will find nothing resulting in INSERTs into the database.</p><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>Server has to be set to run all managed modules for all request, otherwise put operation will fail because of unauthorized access.</p><p><code>&lt;modules runAllManagedModulseForAllRequest=&quot;true&quot;&gt;</code></p><p><code>&lt;/modules&gt;</code></p></div></div><h1 id="DataPage-Pagination">Pagination</h1><p>You can use built-in data pagination functions to return pages of data instead of whole lists. See <a href="LoadData-Method_7831961.html">LoadData Method</a> for details.</p><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body">You need to map the input parameters to the internal <code>_pageNumber</code> and <code>_pageSize</code> parameters the same way you would map other parameters. See <a class="createlink" href="/pages/createpage.action?spaceKey=architect&amp;title=Kendo+Mobile+%E2%80%93+Pagination+And+Server+Side+Filtering&amp;linkCreation=true&amp;fromPageId=8290904">Kendo Mobile - Pagination And Server Side Filtering</a> for an example.</div></div><h1 id="DataPage-DeletingData">Deleting Data</h1><p>When you wan to send a request that will delete data you need to:</p><ol><li>Set AllowDELETE to True</li><li>Send a request to the URL, e.g. <code><span>/api/invoice/1234</span></code></li><li><span>The data will get loaded and then deleted.</span></li></ol><h1 id="DataPage-ConcurrencyHandling">Concurrency Handling</h1><p>As you see from the previous example there is no concurrency handling built-in and the last write wins.</p>
                    </div>

                                        
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Jun 29, 2022 20:33</p>
                    <div id="footer-logo"><a href="https://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
