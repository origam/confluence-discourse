# web.config Configuration

-   [Portal Title](#web.configConfiguration-PortalTitle)
-   [No Access Url](#web.configConfiguration-NoAccessUrl)
-   [Request Limits](#web.configConfiguration-RequestLimits)
-   [Password Recovery Support](#web.configConfiguration-PasswordRecoverySupport)
-   [Suppressing report tabs](#web.configConfiguration-Suppressingreporttabs)
-   [E-Mail Settings](#web.configConfiguration-E-MailSettings)
    -   [Password RESET](#web.configConfiguration-PasswordRESET)

# Portal Title

This entry sets the title of the portal in the web browser.

**Portal Title Example**

``` xml
<appSettings>
    <add key="portalTitle" value="MY ASAP APP" />
</appSettings>
```

# No Access Url

If user logs into the application and doesn't have rights to any screen, she's redirected to so called "no access page". By default it is `/NoAccess.cshtml`. It can be changed through the entry in `appSettings`.

**No Access URL Example**

``` xml
<appSettings>
    <add key="noAccessUrl" value="/NoAccess2.cshtml" />
</appSettings>
```

#  Request Limits

This entry sets the maximum request length (e.g. attachment size) and duration (also important for attachments-the slower the network, the more time you need to upload an attachment).

For more information and additional options see this [MSDN article](http://msdn.microsoft.com/en-us/library/e1f13641.aspx).

**Example**

``` html/xml
<system.web>
    <httpRuntime maxRequestLength="4096" executionTimeout="480" />
</system.web>
```

# Password Recovery Support

**Password Recovery Support**

``` html/xml
<appSettings>
    <add key="supportsPasswordRecovery" value="false" />
</appSettings>
```

If the authentication is done via LDAP, the password recovery should be disabled. It is not implemented in the provider anyway. The setting is also relevant for user registration.

# Suppressing report tabs

You application might require to open reports (PDF file) in an external application instead of browser. This can be done by adjusting `Startup.cs` and to prevent web client from creating empty tabs add following setting.

**Suppress Report Tabs Example**

``` xml
<appSettings>
    <add key="suppressReportTabs" value="true" />
</appSettings>
```

# E-Mail Settings

## Password RESET

You have to configure the following settings in order to get the password reset functionality working.

Please add the following code lines into AppCode/startup.cs file into CreateUserManager() function

``` java
        // this is optional - you can unlock a user when password has been successfully reset 
        manager.UnlocksOnPasswordReset = true;
 
        // reset password token generation settings      
        DpapiDataProtectionProvider protectionProvider 
            = new DpapiDataProtectionProvider("Origam");
        OrigamTokenProvider tp = new OrigamTokenProvider(
            protectionProvider.Create("Confirmation"));
        // set the token validity interval. If the token is older
        // it return token invalid error message when used
        tp.TokenLifespan = TimeSpan.FromHours(48);
        manager.UserTokenProvider = tp;
```

Please add the following to the web.config of your application

**User Management Notifications**

``` xml
<appSettings>
    <add key="mailFrom" value="info@yourdomain.com"/>
    <add key="PortalBaseUrl" value="http://application.com/" />
    <!-- the following 2 lines are optional. If not present, the default texts from resources are used -->
    <add key="RecoverPasswordMail_Subject" value="Application.com Passwort zurück setzen" />
    <!-- if the first line of the following file starts with "Subject: " followed by a subject,
         then the previous key RecoverPasswordMail_Subject is not used.
         note: Html is supported here at master starting from Feb 2017 --> 
    <add key="RecoverPasswordMail_BodyFileName" value="c:\inetpub\wyby\passwordreset.txt" /> 
</appSettings>
```

The password recovery text file can contain the whole e-mail body, while making it possible to include the following parameters:

<table class="confluenceTable">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="header">
<th class="confluenceTh">Substitution Text</th>
<th class="confluenceTh">Replaced with</th>
</tr>

<tr class="odd">
<td class="confluenceTd"><p><code>&lt;%UserName%&gt;</code></p></td>
<td class="confluenceTd"><p>The Web site user name of the user.</p></td>
</tr>
<tr class="even">
<td class="confluenceTd"><p><code>&lt;%Name%&gt;</code></p></td>
<td class="confluenceTd"><p>Name of the user.</p></td>
</tr>
<tr class="odd">
<td class="confluenceTd"><pre><code>&lt;%Token%&gt;</code></pre></td>
<td class="confluenceTd"><p>Reset password token, need to be sent as 'token' url argument to reset password page</p></td>
</tr>
<tr class="even">
<td class="confluenceTd">&lt;%EscapedUserName%&gt;</td>
<td class="confluenceTd">The Web site user name of the user (url escaped)</td>
</tr>
<tr class="odd">
<td class="confluenceTd">&lt;%TokenValidityHours%&gt;</td>
<td class="confluenceTd">Number of hours (taken from token provider configuration) - see above</td>
</tr>
<tr class="even">
<td class="confluenceTd">&lt;%FirstName%&gt;</td>
<td class="confluenceTd">First name of the user.</td>
</tr>
<tr class="odd">
<td class="confluenceTd">&lt;%PortalBaseUrl%&gt;</td>
<td class="confluenceTd">Base url to compose the URL</td>
</tr>
<tr class="even">
<td class="confluenceTd">&lt;%EscapedName%&gt;</td>
<td class="confluenceTd">Name of the user (Url escaped) <strong>(added in Feb 2017)</strong></td>
</tr>
<tr class="odd">
<td class="confluenceTd">&lt;%UserEmail%&gt;</td>
<td class="confluenceTd">Email of the user <strong>(added in Feb 2017)</strong></td>
</tr>
<tr class="even">
<td class="confluenceTd">&lt;%EscapedUserEmail%&gt;</td>
<td class="confluenceTd">Email of the user (Url escaped) <strong>(added in Feb 2017)</strong></td>
</tr>
</tbody>
</table>

Example of text, html is possible to use only with Master version of Origam, Feb 2017

``` java
Subject: Passwort zurückzusetzen
<html>
Hallo <%Name%>
<br /><br />
Klicke auf den Link um dein Passwort zurückzusetzen. Es wird sich eine Seite öffnen auf der Du ein neues Passwort eingeben kannst. 
<br /><br />
<a href="<%PortalBaseUrl%>ResetPassword?token=<%Token%>&Name=<%EscapedName%>&UserName=<%EscapedUserName%>" target="_blank">Link</a>
<br /><br />
Wenn du dein Passwort gar nicht zurücksetzten willst, wende dich bitte an info@application.com
<br /><br /><br />
Wir wünschen dir weiterhin viel Spass beim application.com!
<br /><br />
Dein application.com team
</html>
```
